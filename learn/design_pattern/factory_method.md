## 工厂方法

也叫 虚拟构造函数、Virtual Constructor、 Factory Method



### 意图

工厂方法模式是一中创建型设计模式，其在父类中提供一个创建对象的方法，允许自类决定实例化对象的类型。



### 问题

假设正在开发一款物流管理应用。最初版本只能处理卡车运输，因此大部分代码都在位于名为 卡车  的类中。

一段时间后，这款应用变得极受欢迎。你每天都能收到十几次来自海外公司的请求，希望应用能够支持海上物流功能。

```如果代码其余备份与现有类已经存在耦合关系，那么想程序中添加新类并没有那么容易。```

这可是个好消息。但是代码问题该如何处理呢？目前大部分代码都与 卡车 类相关。在程序中添加轮船类需要修改全部代码。更糟糕的是，如果你以后需要在程序中支持另外一种运输方式，很可能需要再次对这些代码进行大幅修改。

最后，你将不得不编写繁复的代码，根据不同的运输对象类，在应用中进行不同的处理。



### 解决方案

工厂方法模式建议使用特殊的工厂方法代替对于对象构造函数的直接调用 (即使用new运算符)。 不用担心，对象仍将通过new运算符创建，只是该运算符改在工厂方法中调用。工厂方法返回的对象通常被称为“产品”。

乍看下，这种更改可能无意义：我们只是改变程序中调用构造函数的位置而已。但是，现在你可以在子类中重写工厂方法，从而改变其创建产品的类型。

但有一点需要注意：仅当这些产品具有共同的基类或者接口时，子类才能返回不同类型的产品，同时基类中的工厂方法还应将其返回类型声明为这一共有接口。

举例来说，卡车Truck 和轮船 Ship 类都必须实现运输 Transport 接口，该接口声明了一个名为 deliver 交付的方法。每个类都讲义不同的方式实现该方法： 卡车走陆路交付货物，轮船走海路交付货物。 陆路运输 RoadLogistics 类中的工厂方法返回卡车对象，而海路运输 SeaLogistics 则返回轮船对象。

调用工厂方法的代码(通常被称为客户端代码) 无需了解不同子类返回实际对象之间的差别。客户端讲所有产品视为抽象的运输。 客户端知道所有运输对象都提供交付方法，但是并不关心其具体实现方式。

































